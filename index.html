<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lucky UC Premium</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --gold: #f59e0b; --blue: #3b82f6; --dark: #0f172a; --card: #1e293b; --green: #10b981; --red: #ef4444; }
        body { background-color: var(--dark); color: white; font-family: sans-serif; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; user-select: none; }
        
        /* Yuqori Panel */
        .header { width: 100%; display: flex; justify-content: flex-end; padding: 10px 0; }
        .profile-trigger { background: linear-gradient(135deg, var(--card), #2d3748); padding: 10px 20px; border-radius: 15px; border: 2px solid var(--gold); cursor: pointer; text-align: right; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }

        .main-container { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; }
        
        /* Limit Ko'rinishi */
        .limit-info { font-size: 18px; color: #94a3b8; margin-bottom: 15px; font-weight: bold; }
        .limit-info span { color: var(--gold); }

        /* Asosiy Tanga */
        .click-circle { width: 210px; height: 210px; background: radial-gradient(circle, #60a5fa, #2563eb); border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 70px; box-shadow: 0 0 40px rgba(37, 99, 235, 0.4); border: 8px solid var(--card); cursor: pointer; transition: transform 0.1s; touch-action: manipulation; }
        .click-circle:active { transform: scale(0.92); }
        .click-circle.disabled { filter: grayscale(1); opacity: 0.5; pointer-events: none; }

        /* UC Olish (Exchange) */
        .btn-exchange { background: linear-gradient(to right, #10b981, #059669); color: white; border: none; padding: 15px 30px; border-radius: 20px; font-size: 18px; font-weight: bold; display: none; margin-top: 25px; animation: pulse 2s infinite; cursor: pointer; }

        /* Pastki tugmalar */
        .bottom-bar { position: fixed; bottom: 30px; width: calc(100% - 40px); display: flex; justify-content: space-between; align-items: center; }
        .nav-btn { padding: 12px 20px; border-radius: 12px; font-weight: bold; border: none; cursor: pointer; font-size: 14px; }
        .shop-btn { background: var(--gold); color: black; box-shadow: 0 4px 10px rgba(245, 158, 11, 0.3); }
        .admin-btn { background: var(--card); color: white; border: 1px solid #475569; }

        /* Modallar (Alohida oynalar) */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(10px); z-index: 1000; }
        .modal-content { background: var(--card); margin: 35% auto; padding: 25px; width: 80%; border-radius: 25px; border: 1.5px solid var(--gold); text-align: center; position: relative; }
        .close-x { background: var(--red); color: white; border: none; padding: 10px 20px; border-radius: 10px; margin-top: 20px; width: 100%; font-weight: bold; cursor: pointer; }

        .price-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #334155; }
        .price-row:last-child { border-bottom: none; }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

    <div class="header">
        <div class="profile-trigger" onclick="openProfile()">
            <small style="color:#94a3b8">üë§ HISOBIM</small><br>
            <span id="uc-display" style="color:var(--gold); font-weight:bold; font-size:18px">0 UC</span>
        </div>
    </div>

    <div class="main-container">
        <div class="limit-info">Limit: <span id="taps-left">100</span> / 100</div>
        
        <div id="click-btn" class="click-circle" onclick="handleTap(event)">üí∞</div>
        
        <button id="exchange-btn" class="btn-exchange" onclick="claimUC()">üéÅ UC ALMASHTIRISH</button>
        
        <div id="timer-box" style="display:none; color:var(--red); font-weight:bold; margin-top:15px; text-align:center;">
            Limit tugadi! <br> Tiklanadi: <span id="countdown">00:00:00</span>
        </div>
    </div>

    <div class="bottom-bar">
        <button class="nav-btn shop-btn" onclick="openShop()">üõí UC Narxlari</button>
        <button class="nav-btn admin-btn" onclick="openAdmin()">üë®‚Äçüíª Admin</button>
    </div>

    <div id="profileModal" class="modal">
        <div class="modal-content" style="border-color: var(--blue);">
            <h2 style="margin-top:0; color:var(--blue);">üë§ Mening Hisobim</h2>
            <div style="background:#0f172a; padding:15px; border-radius:15px; margin:15px 0;">
                <p style="margin:5px 0; color:#94a3b8;">Yig'ilgan ballar:</p>
                <div id="modal-pts" style="font-size:30px; font-weight:bold; color:var(--gold);">0</div>
                <hr style="border:0; border-top:1px solid #334155; margin:10px 0;">
                <p style="margin:5px 0; color:#94a3b8;">Mavjud UC:</p>
                <div id="modal-uc" style="font-size:30px; font-weight:bold; color:var(--green);">0 UC</div>
            </div>
            <button class="close-x" onclick="closeModals()">Yopish</button>
        </div>
    </div>

    <div id="shopModal" class="modal">
        <div class="modal-content">
            <h2 style="margin-top:0; color:var(--gold);">üõí UC Narxlari</h2>
            <div style="margin:15px 0;">
                <div class="price-row"><span>üíé 60 UC</span> <b>20,000 Ball</b></div>
                <div class="price-row"><span>üíé 120 UC</span> <b>39,000 Ball</b></div>
                <div class="price-row"><span>üíé 325 UC</span> <b>100,000 Ball</b></div>
            </div>
            <p style="font-size:12px; color:#94a3b8;">Ballar yetarli bo'lganda asosiy ekranda almashtirish tugmasi chiqadi.</p>
            <button class="close-x" onclick="closeModals()">Tushunarli</button>
        </div>
    </div>

    <div id="adminModal" class="modal">
        <div class="modal-content" style="border-color: #fff;">
            <h2 style="margin-top:0;">üë®‚Äçüíª Uc olish</h2>
            <p>Uc shu adminda olishingiz mumkin:</p>
            <div style="background:white; color:black; padding:15px; border-radius:12px; font-weight:bold; font-size:18px;">
                @yaqubov_pro
            </div>
            <button class="close-x" onclick="closeModals()">Yopish</button>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        let pts = parseInt(localStorage.getItem('pts')) || 0;
        let taps = parseInt(localStorage.getItem('taps')) || 0;
        let uc = parseInt(localStorage.getItem('uc')) || 0;
        let lastDate = localStorage.getItem('ldate');

        function updateUI() {
            document.getElementById('taps-left').innerText = (100 - taps);
            document.getElementById('uc-display').innerText = uc + " UC";
            
            let exBtn = document.getElementById('exchange-btn');
            if (pts >= 20000) {
                exBtn.style.display = "block";
                exBtn.innerText = pts >= 39000 ? "üéÅ 120 UC ALMASHTIRISH" : "üéÅ 60 UC ALMASHTIRISH";
            } else { exBtn.style.display = "none"; }

            if (taps >= 100) {
                document.getElementById('click-btn').classList.add('disabled');
                document.getElementById('timer-box').style.display = "block";
                startTimer();
            }
        }

        function handleTap(e) {
            if (taps >= 100) return;
            pts++; taps++;
            localStorage.setItem('pts', pts);
            localStorage.setItem('taps', taps);
            localStorage.setItem('ldate', new Date().getTime());
            tg.HapticFeedback.impactOccurred('medium');
            updateUI();
        }

        function claimUC() {
            let gift = pts >= 39000 ? 120 : 60;
            let cost = gift === 120 ? 39000 : 20000;
            pts -= cost; uc += gift;
            localStorage.setItem('pts', pts);
            localStorage.setItem('uc', uc);
            tg.showAlert(`Muvaffaqiyatli! ${gift} UC qo'shildi.`);
            updateUI();
        }

        function openProfile() {
            document.getElementById('modal-pts').innerText = pts.toLocaleString();
            document.getElementById('modal-uc').innerText = uc + " UC";
            document.getElementById('profileModal').style.display = 'block';
        }

        function openShop() { document.getElementById('shopModal').style.display = 'block'; }
        function openAdmin() { document.getElementById('adminModal').style.display = 'block'; }
        function closeModals() { document.querySelectorAll('.modal').forEach(m => m.style.display = 'none'); }

        function startTimer() {
            let next = parseInt(lastDate) + 86400000;
            setInterval(() => {
                let diff = next - new Date().getTime();
                if (diff <= 0) { location.reload(); }
                let h = Math.floor(diff / 3600000);
                let m = Math.floor((diff % 3600000) / 60000);
                let s = Math.floor((diff % 60000) / 1000);
                document.getElementById('countdown').innerText = h + "h " + m + "m " + s + "s";
            }, 1000);
        }

        updateUI();
    </script>
</body>
</html>